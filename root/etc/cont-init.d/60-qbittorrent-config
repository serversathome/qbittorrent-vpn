#!/usr/bin/with-contenv bash

echo "Configuring qBittorrent for VPN..."

# Wait for qBittorrent config directory
mkdir -p /config/qBittorrent

# Configure qBittorrent to use VPN port if specified
if [ -f /tmp/vpn_port ]; then
    VPN_PORT=$(cat /tmp/vpn_port)
    echo "Setting qBittorrent listening port to: $VPN_PORT"
    
    # We'll set this via environment variable for qBittorrent to pick up
    export QBITTORRENT_PORT=$VPN_PORT
fi

# Bind qBittorrent to all interfaces (0.0.0.0) so we can access WebUI from local network
echo "qBittorrent will bind to 0.0.0.0 for WebUI access"

echo "qBittorrent configuration complete!"
